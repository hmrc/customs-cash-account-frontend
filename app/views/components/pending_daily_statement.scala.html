@*
 * Copyright 2021 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import viewmodels.PaginatedPendingDailyStatement

@import helpers.Formatters
@import views.html.components.cash_transactions_payment_header

@this(paymentHeader : cash_transactions_payment_header)

@(model: CashAccountViewModel, index: Int, pendingDailyStatement: PaginatedPendingDailyStatement)(implicit messages: Messages)
@if(index == 0) {
 <h3 class="govuk-heading-m  govuk-!-padding-top-4 govuk-!-margin-bottom-1" id="@{s"pending-heading-${pendingDailyStatement.date}"}" aria-describedby="@{s"pending-detail-${pendingDailyStatement.date}"}"> @{Formatters.dateAsDayMonthAndYear(pendingDailyStatement.date)}</h3>
 <p class="govuk-body govuk-!-margin-bottom-2" id="@{
  s"pending-detail-${pendingDailyStatement.date}"
 }"> @{
  model.account.balances.AvailableAccountBalance.fold(""){balance => messages("cf.cash-account.detail.available-balance", Formatters.formatCurrencyAmount(balance))}
 }</p>
} else {
 <h3 class="govuk-heading-m  govuk-!-padding-top-4 govuk-!-margin-bottom-1" id="@{s"pending-heading-${pendingDailyStatement.date}"}"> @{Formatters.dateAsDayMonthAndYear(pendingDailyStatement.date)}</h3>
}
<table class="govuk-table hmrc-responsive-table govuk-!-margin-bottom-6" id="@{s"pending-table-${pendingDailyStatement.date}"}">
 <caption class="govuk-visually-hidden">
 @messages("cf.cash-account.detail.payments-caption", Formatters.dateAsDayMonthAndYear(pendingDailyStatement.date))
 </caption>
 @paymentHeader()
 <tbody class="govuk-table__body">
@for(pendingTransaction <- pendingDailyStatement.declarations) {
   <tr class="govuk-table__row">
    <th class="govuk-table__header govuk-!-font-weight-regular" scope="row">
     <span class="hmrc-responsive-table__heading" aria-hidden="true">@messages("cf.cash-account.detail.mrn")</span>
     @{pendingTransaction.movementReferenceNumber}
    </th>
    <td class="govuk-table__cell">
     <span class="hmrc-responsive-table__heading" aria-hidden="true">@messages("cf.cash-account.detail.ucr")</span>
     @{pendingTransaction.declarantReference.getOrElse(" ")}
    </td>
    <td class="govuk-table__cell">
     <span class="hmrc-responsive-table__heading" aria-hidden="true">
      @messages("cf.cash-account.detail.declarant")
      @messages("cf.cash-account.detail.eori")
     </span>
     @{pendingTransaction.declarantEori}
    </td>
    <td class="govuk-table__cell govuk-table__cell--numeric amount">
     <span class="hmrc-responsive-table__heading" aria-hidden="true">@messages("cf.cash-account.detail.amount")</span>
     @{Formatters.formatCurrencyAmount(pendingTransaction.amount)}
    </td>
   </tr>
}
 </tbody>
</table>